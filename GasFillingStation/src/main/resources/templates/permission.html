<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link th:href="@{/css/permission.css}" rel="stylesheet" />
<link th:href="@{/bootstrap-3.3.4-dist/css/bootstrap.min.css}" rel="stylesheet" />
<title>加气站管理系统</title>
</head>
<body>
<div th:include="header" style="width:100%;"></div>
<div class="permission" ng-controller="permission">
    <div class="main">
        <div class="employee-list border" ng-show="currentPermission == 'menuPermission'">
            <div class="table">
                <div class="title block-title">
                    <span class="ng-cloak">权限管理</span>
                    <span class="operate" ng-show="showResult"><span style="background-color: green;padding: 5px 10px;">操作成功</span></span>
                    <span class="addUserBtn btn" ng-click="showUserRoleManage('userRoleManage')">角色管理</span>
                </div>
                <ul class="table-title">
                    <li class="col"></li>
                    <li class="col" ng-repeat="menu in menus">{{menu.name}}</li>
                </ul>
                <ul class="table-content ng-cloak" ng-repeat="role in roles">
                    <li class="col">{{role.name}}</li>
                    <li class="col" ng-repeat="menu in menus"><input type="checkbox" ng-checked="checkRoleHasMenu(role, menu)" ng-click="changePermission(role, menu)"/></li>
                </ul>
            </div>
        </div>
        <div class="user-role border" ng-show="currentPermission == 'userRoleManage'">
            <div class="table">
                <div class="title block-title">
                    <span class="ng-cloak">权限管理</span>
                    <span class="operate" ng-show="showResult"><span style="background-color: green;padding: 5px 10px;">操作成功</span></span>
                    <span class="titleBtn btn btn-small" ng-click="showUserRoleManage('menuPermission')">菜单管理</span>
                </div>
                <ul class="table-title">
                    <li class="col col1">用户名</li>
                    <li class="col col2">电话</li>
                    <li class="col col3">身份证</li>
                    <li class="col col4">角色</li>
                </ul>
                <ul class="table-content ng-cloak" ng-repeat="user in users">
                    <li class="col col1"><a ng-click="showChangeRolePage(user)">{{user.name}}</a></li>
                    <li class="col col2">{{user.phone}}</li>
                    <li class="col col3">{{user.idcard}}</li>
                    <li class="col col4">{{user.role.name}}</li>
                </ul>
            </div>
            <pagenation go-page="gotoPage(page)" total-pages="totalPages" change-size="changeRowNums(num)"></pagenation>
        </div>
        <div class="addUser ng-hide" ng-show="showChangeRole">
            <div class="addUserMask"></div>
            <div class="table">
                <div class="title block-title-backcolor">
                    <span style="font-size: 14pt;">修改权限</span>
                    <span class="close right" ng-click="closeShowChangeRolePopup()">X</span>
                </div>
                <div class="item">
                    <span class="col col1">用户:</span>
                    <input type="text" class="col col2" readonly="readonly" ng-model="currentChangeUser.name"/>
                </div>
                <div class="item">
                    <span class="col col1">当前权限:</span>
                    <input type="text" class="col col2" readonly="readonly" ng-model="currentChangeUser.role.name"/>
                </div>
                <div class="item">
                    <span class="col col1">变更为:</span>
                    <select class="col col2" ng-model="currentChangeUser.role.id">
                        <option ng-repeat="role in roles" value="{{role.id}}">{{role.name}}</option>
                    </select>
                </div>
                <div class="btngroup">
                    <span class="btn btn-reset btn-primary" ng-click="closeShowChangeRolePopup()">取消</span>
                    <span class="btn btn-submit btn-primary" ng-click="submitChangeRole()">提交</span>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/common.js"></script>
<script type="text/javascript" src="/js/permission.js"></script>
</body>
</html>